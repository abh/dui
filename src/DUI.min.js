(function(){[].indexOf||(Array.prototype.indexOf=function(a,b){b=b==null?0:b;var e=this.length;for(b=b;b<e;b++)if(this[b]==a)return b;return-1});[].filter||(Array.prototype.filter=function(a,b){var e=this.length>>>0,c=[];b=b;for(var d=0;d<e;d++)if(d in this){var f=this[d];a.call(b,f,d,this)&&c.push(f)}return c});DUI=function(a,b,e){if(arguments.length==1)b=a;b=b&&b.constructor==Function?b:function(){};var c=b.toString(),d=/(DUI\.\w+)/gim,f=[],h;if(e&&e.newQ&&DUI.currentQ.length>0)DUI.currentQ=DUI.actions[DUI.actions.push([])- 1];if(a&&a.constructor==Array)f=a;for(DUI.loadedScripts.concat(DUI.loading).indexOf(DUI.jQueryURL)==-1&&DUI.load(DUI.jQueryURL);h=d.exec(c);){var m=true;h=h[1]||null;var g=["isClass","global","prototype","_dontEnum","_ident","_bootstrap","init","create","ns","each"],p=["clean"];if(g.indexOf(h.replace("DUI.",""))>-1)h="DUI.Class";for(g=0;g<f.length;g++)if(f[g]==h)m=false;m&&p.indexOf(h.replace("DUI.",""))==-1&&f.push(h)}DUI.currentQ.push(b);for(g=0;g<f.length;g++)DUI.load(f[g],e);DUI.loading.length== 0&&DUI.loaded()};DUI.loading=[];DUI.actions=[];DUI.currentQ=DUI.actions[DUI.actions.push([])-1];DUI.loadedScripts=[];DUI.jQueryURL="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.js";DUI.scriptURL="http://"+window.location.hostname+"/";DUI.maps={};DUI.debug=false;DUI.load=function(a,b){if(!(DUI.loading.indexOf(a)>-1))if(DUI.loadedScripts.indexOf(a)>-1)DUI.loaded(a,b);else{var e=a;a=a.split(/:(?!\/\/)/);for(var c=0;c<a.length;c++)if(DUI.maps[a[c]])a[c]=DUI.maps[a[c]];a=a.join("/");a=a.indexOf("http")== 0?a:a.indexOf("DUI.")>-1?DUI.scriptURL+"DUI/"+a+".js":DUI.scriptURL+a+".js";if(a.indexOf("http")==0&&a.indexOf(".js")!=a.length-3)a+=".js";if(DUI.debug){c=a.search(/(\?|&)/)>-1?"&":"?";a+=c+(new Date).getTime()}DUI.loading.push(e);c=document;var d=c.createElement("script"),f="setAttribute";d[f]("type","text/javascript");d[f]("src",a);d.onload=function(){DUI.loaded(e,b)};d.onreadystatechange=function(){"loadedcomplete".indexOf(d.readyState)>-1&&DUI.loaded(e,b)};c.body.appendChild(d)}};DUI.loaded=function(a){DUI.loading= DUI.loading.filter(function(c){return c!=a});a&&DUI.loadedScripts.push(a);if(DUI.loading.length==0){for(;DUI.actions.length>0;)for(var b=DUI.actions.shift();b.length>0;){var e=b.pop();e.apply(DUI)}DUI.actions=[[]];DUI.currentQ=DUI.actions[0]}};DUI.clean=function(a){if(a.constructor==Array)$.each(a,function(){DUI.clean(this)});else{var b=a.replace(/([:\.]{1})/g,"\\$1");$("._view\\:"+b+", ._click\\:"+b+", ._hover\\:"+b+", ._load\\:"+b).removeClass("_view:"+a+" _click:"+a+" _hover:"+a+" _load:"+a)}}; var i=document,k="addEventListener",j="attachEvent",l=function(a){a=a||window.event;if(!(a.button==2||a.ctrlKey||a.metaKey)){var b=a.type,e=a.target||a.srcElement,c=e.className,d=c.match(/(?:^|\s)_(click|hover):(\S+)(?:$|\s)/);if(d&&d[1]&&d[2])if(d[1]=="hover"&&b=="mouseover"||d[1]=="click"&&b=="click"){d=d[2];if(e.className.indexOf("booting")==-1){e.className=c+" booting";DUI([d],function(){DUI.clean(d);var f=new $.Event(b);f.fromDUI=true;$(e).removeClass("booting").trigger(f)},{newQ:true})}a.preventDefault? a.preventDefault():(a.returnValue=false)}}},n=function(){for(var a='class="'+document.body.className+'" '+document.body.innerHTML,b=/class=(?:'|")(?:[^'"]*?)_load:([^\s"']+)(?:[^'"]*?)(?:'|")/gim,e=[],c;c=b.exec(a);){var d=true;c=c[1]||null;for(var f=0;f<e.length;f++)if(e[f]==c)d=false;d&&e.push(c)}DUI(e,function(){DUI.clean(e)},{newQ:true})},o=function(){var a=window.innerHeight,b=window.scrollY,e=[],c;if(document.querySelectorAll){qsa=document.querySelectorAll("*[class*=_view]");for(var d=0;d<qsa.length;d++){c= qsa[d];a+b>c.offsetTop&&e.push(/(?:^|\s)_view:([^\s]+)(?:\s|$)/.exec(c.className)[1])}}else console.log("no");if(e.length>0){c.className+=" booting";DUI(e,function(){$(c).removeClass("booting");DUI.clean(e)},{newQ:true})}};if(i[j]){i[j]("onclick",l);i[j]("onmouseover",l);i[j]("onscroll",o);window[j]("onload",n)}else{i[k]("click",l,false);i[k]("mouseover",l,false);i[k]("scroll",o,false);window[k]("load",n,false)}})();
